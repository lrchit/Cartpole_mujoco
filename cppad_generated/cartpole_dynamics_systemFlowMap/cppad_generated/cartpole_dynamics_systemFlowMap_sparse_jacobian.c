#include <math.h>
#include <stdio.h>

typedef struct Array {
    void* data;
    unsigned long size;
    int sparse;
    const unsigned long* idx;
    unsigned long nnz;
} Array;

struct LangCAtomicFun {
    void* libModel;
    int (*forward)(void* libModel,
                   int atomicIndex,
                   int q,
                   int p,
                   const Array tx[],
                   Array* ty);
    int (*reverse)(void* libModel,
                   int atomicIndex,
                   int p,
                   const Array tx[],
                   Array* px,
                   const Array py[]);
};

void cartpole_dynamics_systemFlowMap_sparse_jacobian(double const *const * in,
                                                     double*const * out,
                                                     struct LangCAtomicFun atomicFun) {
   //independent variables
   const double* x = in[0];

   //dependent variables
   double* jac = out[0];

   // auxiliary variables
   double v[54];

   v[0] = sin(x[1]);
   v[1] = 0.05 * v[0];
   v[2] = v[1] * x[3];
   v[3] = 2.943 * v[0];
   v[4] = cos(x[1]);
   v[5] = 0.3 * v[4];
   v[6] = 1.1 - (v[5] * v[4]) / 4.;
   v[7] = (v[2] * x[3] + x[4] - (v[3] * v[4]) / 4.) / v[6];
   v[0] = x[3] + 0.5 * 0.005 * ((3. * (9.81 * v[0] - v[7] * v[4])) / 4.) / 0.5;
   v[8] = x[1] + 0.5 * 0.005 * v[0];
   v[9] = cos(v[8]);
   v[10] = 0.3 * v[9];
   v[11] = 1.1 - (v[10] * v[9]) / 4.;
   v[12] = 4.16666666666667e-06 * 1 / v[11];
   v[13] = sin(v[8]);
   v[14] = 0.05 * v[13];
   v[15] = x[1] + 0.5 * 0.005 * x[3];
   v[16] = sin(v[15]);
   v[17] = 0.05 * v[16];
   v[18] = v[17] * v[0];
   v[19] = 2.943 * v[16];
   v[20] = cos(v[15]);
   v[21] = 0.3 * v[20];
   v[22] = 1.1 - (v[21] * v[20]) / 4.;
   v[23] = (v[18] * v[0] + x[4] - (v[19] * v[20]) / 4.) / v[22];
   v[16] = x[3] + 0.5 * 0.005 * ((3. * (9.81 * v[16] - v[23] * v[20])) / 4.) / 0.5;
   v[24] = v[14] * v[16];
   v[25] = 2.943 * v[13];
   v[26] = (v[24] * v[16] + x[4] - (v[25] * v[9]) / 4.) / v[11];
   v[27] = (0 - (0 - v[12] * v[26])) * 0.25;
   v[28] = (0 - v[12]) * 0.25;
   v[29] = sin(v[8]);
   v[30] = v[12] * v[16];
   v[8] = cos(v[8]);
   v[28] = 0 - (v[27] * v[10] + v[27] * v[9] * 0.3 + v[28] * v[25]) * v[29] + (v[28] * v[9] * 2.943 + v[30] * v[16] * 0.05) * v[8];
   v[30] = v[12] * v[24] + v[30] * v[14];
   v[27] = v[30] * 0.5 * 0.005 * 2. * 0.25 * 3.;
   v[31] = 0 - v[27];
   v[32] = (4.16666666666667e-06 + v[31] * v[20]) * 1 / v[22];
   v[33] = (0 - (0 - v[32] * v[23])) * 0.25;
   v[34] = (0 - v[32]) * 0.25;
   v[35] = sin(v[15]);
   v[36] = v[32] * v[0];
   v[15] = cos(v[15]);
   v[34] = 0 - (v[31] * v[23] + v[33] * v[21] + v[33] * v[20] * 0.3 + v[34] * v[19]) * v[35] + (v[27] * 9.81 + v[34] * v[20] * 2.943 + v[36] * v[0] * 0.05) * v[15];
   v[36] = v[28] * 0.5 * 0.005 + v[32] * v[18] + v[36] * v[17];
   v[33] = v[36] * 0.5 * 0.005 * 2. * 0.25 * 3.;
   v[31] = 0 - v[33];
   v[27] = (4.16666666666667e-06 + v[31] * v[4]) * 1 / v[6];
   v[37] = (0 - (0 - v[27] * v[7])) * 0.25;
   v[38] = (0 - v[27]) * 0.25;
   v[39] = sin(x[1]);
   v[40] = v[27] * x[3];
   v[41] = cos(x[1]);
   jac[1] = v[28] + v[34] - (v[31] * v[7] + v[37] * v[5] + v[37] * v[4] * 0.3 + v[38] * v[3]) * v[39] + (v[33] * 9.81 + v[38] * v[4] * 2.943 + v[40] * x[3] * 0.05) * v[41];
   jac[3] = v[30] + v[36] + v[34] * 0.5 * 0.005 + v[27] * v[2] + v[40] * v[1];
   jac[4] = v[12] + v[32] + v[27];
   v[27] = -6.25e-06 * v[9] * 1 / v[11];
   v[32] = (0 - (0 - v[27] * v[26])) * 0.25;
   v[12] = (0 - v[27]) * 0.25;
   v[40] = v[27] * v[16];
   v[12] = 0 - (-6.25e-06 * v[26] + v[32] * v[10] + v[32] * v[9] * 0.3 + v[12] * v[25]) * v[29] + (6.13125e-05 + v[12] * v[9] * 2.943 + v[40] * v[16] * 0.05) * v[8];
   v[40] = 0.00166666666666667 + v[27] * v[24] + v[40] * v[14];
   v[32] = v[40] * 0.5 * 0.005 * 2. * 0.25 * 3.;
   v[36] = 0 - v[32];
   v[34] = v[36] * v[20] * 1 / v[22];
   v[30] = (0 - (0 - v[34] * v[23])) * 0.25;
   v[38] = (0 - v[34]) * 0.25;
   v[37] = v[34] * v[0];
   v[38] = 0 - (v[36] * v[23] + v[30] * v[21] + v[30] * v[20] * 0.3 + v[38] * v[19]) * v[35] + (v[32] * 9.81 + v[38] * v[20] * 2.943 + v[37] * v[0] * 0.05) * v[15];
   v[37] = (0.333333333333333 + v[12] * 0.5) * 0.005 + v[34] * v[18] + v[37] * v[17];
   v[30] = v[37] * 0.5 * 0.005 * 2. * 0.25 * 3.;
   v[36] = 0 - v[30];
   v[32] = v[36] * v[4] * 1 / v[6];
   v[31] = (0 - (0 - v[32] * v[7])) * 0.25;
   v[33] = (0 - v[32]) * 0.25;
   v[28] = v[32] * x[3];
   jac[5] = 1 + v[12] + v[38] - (v[36] * v[7] + v[31] * v[5] + v[31] * v[4] * 0.3 + v[33] * v[3]) * v[39] + (v[30] * 9.81 + v[33] * v[4] * 2.943 + v[28] * x[3] * 0.05) * v[41];
   jac[6] = 0.000833333333333333 + v[40] + v[37] + (0.166666666666667 + v[38] * 0.5) * 0.005 + v[32] * v[2] + v[28] * v[1];
   jac[7] = v[27] + v[34] + v[32];
   v[32] = x[1] + 0.005 * v[16];
   v[34] = cos(v[32]);
   v[27] = 0.3 * v[34];
   v[28] = 1.1 - (v[27] * v[34]) / 4.;
   v[37] = 0.000833333333333333 * 1 / v[28];
   v[38] = sin(v[32]);
   v[40] = 0.05 * v[38];
   v[13] = x[3] + 0.005 * ((3. * (9.81 * v[13] - v[26] * v[9])) / 4.) / 0.5;
   v[33] = v[40] * v[13];
   v[38] = 2.943 * v[38];
   v[31] = (v[33] * v[13] + x[4] - (v[38] * v[34]) / 4.) / v[28];
   v[36] = (0 - (0 - v[37] * v[31])) * 0.25;
   v[30] = (0 - v[37]) * 0.25;
   v[12] = sin(v[32]);
   v[42] = v[37] * v[13];
   v[32] = cos(v[32]);
   v[30] = 0 - (v[36] * v[27] + v[36] * v[34] * 0.3 + v[30] * v[38]) * v[12] + (v[30] * v[34] * 2.943 + v[42] * v[13] * 0.05) * v[32];
   v[42] = v[37] * v[33] + v[42] * v[40];
   v[36] = v[42] * 0.005 * 2. * 0.25 * 3.;
   v[43] = 0 - v[36];
   v[44] = (0.00166666666666667 + v[43] * v[9]) * 1 / v[11];
   v[45] = (0 - (0 - v[44] * v[26])) * 0.25;
   v[46] = (0 - v[44]) * 0.25;
   v[47] = v[44] * v[16];
   v[46] = 0 - (v[43] * v[26] + v[45] * v[10] + v[45] * v[9] * 0.3 + v[46] * v[25]) * v[29] + (v[36] * 9.81 + v[46] * v[9] * 2.943 + v[47] * v[16] * 0.05) * v[8];
   v[47] = v[30] * 0.005 + v[44] * v[24] + v[47] * v[14];
   v[45] = v[47] * 0.5 * 0.005 * 2. * 0.25 * 3.;
   v[43] = 0 - v[45];
   v[36] = (0.00166666666666667 + v[43] * v[20]) * 1 / v[22];
   v[48] = (0 - (0 - v[36] * v[23])) * 0.25;
   v[49] = (0 - v[36]) * 0.25;
   v[50] = v[36] * v[0];
   v[49] = 0 - (v[43] * v[23] + v[48] * v[21] + v[48] * v[20] * 0.3 + v[49] * v[19]) * v[35] + (v[45] * 9.81 + v[49] * v[20] * 2.943 + v[50] * v[0] * 0.05) * v[15];
   v[50] = v[46] * 0.5 * 0.005 + v[36] * v[18] + v[50] * v[17];
   v[48] = v[50] * 0.5 * 0.005 * 2. * 0.25 * 3.;
   v[43] = 0 - v[48];
   v[45] = (0.000833333333333333 + v[43] * v[4]) * 1 / v[6];
   v[51] = (0 - (0 - v[45] * v[7])) * 0.25;
   v[52] = (0 - v[45]) * 0.25;
   v[53] = v[45] * x[3];
   jac[8] = v[30] + v[46] + v[49] - (v[43] * v[7] + v[51] * v[5] + v[51] * v[4] * 0.3 + v[52] * v[3]) * v[39] + (v[48] * 9.81 + v[52] * v[4] * 2.943 + v[53] * x[3] * 0.05) * v[41];
   jac[10] = v[42] + v[47] + v[50] + v[49] * 0.5 * 0.005 + v[45] * v[2] + v[53] * v[1];
   jac[11] = v[37] + v[44] + v[36] + v[45];
   v[28] = -0.00125 * v[34] * 1 / v[28];
   v[45] = (0 - (0 - v[28] * v[31])) * 0.25;
   v[36] = (0 - v[28]) * 0.25;
   v[44] = v[28] * v[13];
   v[36] = 0 - (-0.00125 * v[31] + v[45] * v[27] + v[45] * v[34] * 0.3 + v[36] * v[38]) * v[12] + (0.0122625 + v[36] * v[34] * 2.943 + v[44] * v[13] * 0.05) * v[32];
   v[44] = v[28] * v[33] + v[44] * v[40];
   v[33] = (0.333333333333333 + v[44]) * 0.005 * 2. * 0.25 * 3.;
   v[40] = 0 - v[33];
   v[11] = v[40] * v[9] * 1 / v[11];
   v[45] = (0 - (0 - v[11] * v[26])) * 0.25;
   v[32] = (0 - v[11]) * 0.25;
   v[12] = v[11] * v[16];
   v[32] = 0 - (v[40] * v[26] + v[45] * v[10] + v[45] * v[9] * 0.3 + v[32] * v[25]) * v[29] + (v[33] * 9.81 + v[32] * v[9] * 2.943 + v[12] * v[16] * 0.05) * v[8];
   v[12] = v[36] * 0.005 + v[11] * v[24] + v[12] * v[14];
   v[24] = (0.333333333333333 + v[12] * 0.5) * 0.005 * 2. * 0.25 * 3.;
   v[14] = 0 - v[24];
   v[22] = v[14] * v[20] * 1 / v[22];
   v[45] = (0 - (0 - v[22] * v[23])) * 0.25;
   v[40] = (0 - v[22]) * 0.25;
   v[33] = v[22] * v[0];
   v[40] = 0 - (v[14] * v[23] + v[45] * v[21] + v[45] * v[20] * 0.3 + v[40] * v[19]) * v[35] + (v[24] * 9.81 + v[40] * v[20] * 2.943 + v[33] * v[0] * 0.05) * v[15];
   v[33] = v[32] * 0.5 * 0.005 + v[22] * v[18] + v[33] * v[17];
   v[18] = (0.166666666666667 + v[33] * 0.5) * 0.005 * 2. * 0.25 * 3.;
   v[17] = 0 - v[18];
   v[6] = v[17] * v[4] * 1 / v[6];
   v[45] = (0 - (0 - v[6] * v[7])) * 0.25;
   v[14] = (0 - v[6]) * 0.25;
   v[24] = v[6] * x[3];
   jac[12] = v[36] + v[32] + v[40] - (v[17] * v[7] + v[45] * v[5] + v[45] * v[4] * 0.3 + v[14] * v[3]) * v[39] + (v[18] * 9.81 + v[14] * v[4] * 2.943 + v[24] * x[3] * 0.05) * v[41];
   jac[13] = 1 + v[44] + v[12] + v[33] + v[40] * 0.5 * 0.005 + v[6] * v[2] + v[24] * v[1];
   jac[14] = v[28] + v[11] + v[22] + v[6];
   // dependent variables without operations
   jac[0] = 1;
   jac[2] = 0.005;
   jac[9] = 1;
}

